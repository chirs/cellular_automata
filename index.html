<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Langtons Ant</title>

  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="verify-v1" content="ES7MT4WW7ZSsA5/BJKdhUjxWnzEkJL8E0UdRHLlL9Yo=" />
  <meta name="description" content="Langton's Ant">

  <link rel="stylesheet" type="text/css" href="style.css" />
  <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />

  <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
  <script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js"></script>

  <script type="text/javascript" src="ant.js"></script>
  <script type="text/javascript" src="draw.js"></script>


  <script type="text/javascript">
    $(document).ready(function() {
      HEIGHT = 500 
      ZOOM = 3; // Zoom is modified by the zoom slider.

      var intervalID, ant;

      var running = false;
      var canvas = document.getElementById("antBoard");
      var ctx = canvas.getContext("2d");

      var redrawBoard = function(){
        var cl = ant.allColors()
        for (var i=0; i < cl.length; i++){
          fillCoord(cl[i][0], cl[i][1]);
        };
      };

      var setZoom = function(){
        var z = $("#slider").slider("value")
        if ( z ) {
          ZOOM = z;
          clearCanvas();
          redrawBoard();
        }
      };

      // Move 0,0 from upper-left to center of screen.
      var translateCoord = function(coord){
        var center = HEIGHT / (2 * ZOOM)
        return [coord[0] + center, coord[1] + center]
      }

      // Color a coordinate.
      // (make this more sophisticated)
      var fillCoord = function(coord, style){
        var ncoord = translateCoord(coord);
        var x = ncoord[0] * ZOOM ;
        var y = ncoord[1] * ZOOM ;
        ctx.fillStyle = style;
        ctx.fillRect(x,y,ZOOM,ZOOM);

      };

      var antMove = function(speed){
        speed = speed || parseInt($("#speed").val()) || 1;

        for (var i=0; i < speed; i++){
          var m = ant.move();
          fillCoord(m.coord, m.color);
        }
      };

      var clearCanvas = function(){
        ctx.clearRect(0,0,canvas.width,canvas.height);
      };

      var unPause = function(){
        intervalID = setInterval(antMove, 1);
        running = true;
        $("#pause").val("pause");
      };

      var pause = function(){
        clearInterval(intervalID);
        running = false;
        $("#pause").val("unpause");
      };

      var pauseUnpause = function() { if (running) { pause() } else { unPause() } };


      var start = function(generation) { 
        clearCanvas();

        var pattern = $("#description").val()
        ant = makeAnt(pattern, generateColors(pattern.length));
        //console.log(generateColors(pattern.length));

        var generation = parseInt($("#generation").val());
        generation = generation || 0;

        for (var i=0; i<generation; i++){
          antMove(1);
        }
        pause(); // need to balance with unpause to maintain intervalID...fix.
        unPause();
      };
      
      $("#pause").click(pauseUnpause);
      $("#restart").click(start);

      $("#slider").slider({
        orientation: "vertical", max: 10, min: .1, value: 3, step: .1,
        change: setZoom,
      });
      $("#slider").height(480);
      start();


    });




  </script>

</head>


<body class="home">

<h2><a href="http://en.wikipedia.org/wiki/Langton's_ant">Langton's Ant</a>: a two-dimensional Turing machine</h2>

<div>

<div><label>pattern</label><input id="description" type="input" value="LLRR"></div>
<!--<div><label>generation</label><input id="generation" type="input" value="0"></div>-->
<div><label>speed</label><input id="speed" type="input" value="100"></div>
<div>
  <input id="restart" type="submit" value="restart">
  <input id="pause" type="submit" value="pause">
</div>


</div>

<canvas id="antBoard" width="500" height="500"></canvas>
  <div style="display:inline-block" height="500" id="slider"></div><div id="slider"></div>


</body>
